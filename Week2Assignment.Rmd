---
title: "My Assignment"
date: "February 17, 2017"
output: html_document
runtime: shiny
---


```{r, echo=FALSE}
library(leaflet)
sidebarPanel(
   selectInput("city","Beijing Attractions",choices =c("Forbidden City","Great Wall","Summer Palace","Temple of Heaven","Beihai Park","Ming Tombs","Tiananmen Square")),
   checkboxInput("legend", "Add Rectangle", TRUE)
)
mainPanel(
renderLeaflet({
    
      myIcon <-iconList(makeIcon(
          iconUrl = "http://appwk.baidu.com/naapi/doc/view?ih=810&rn=1&doc_id=0273aee51ed9ad51f01df2cc&o=jpg_6&pn=1&iw=1440&ix=0&sign=e71e83d5283f8b5342c1ea464d8eaa60&type=1&iy=0&aimw=1440&app_ver=2.9.8.2&ua=bd_800_800_IncredibleS_2.9.8.2_2.3.7&bid=1&app_ua=IncredibleS&uid=&cuid=&fr=3&Bdi_bear=WIFI&from=3_10000&bduss=&pid=1&screen=800_800&sys_ver=2.3.7",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),makeIcon(
          iconUrl = "http://appwk.baidu.com/naapi/doc/view?ih=810&o=jpg_6&iw=1080&ix=0&iy=0&aimw=1080&rn=1&doc_id=401989135901020206409c09&pn=1&sign=67d5f49dbf238ca67de2faa1743ac00d&type=1&app_ver=2.9.8.2&ua=bd_800_800_IncredibleS_2.9.8.2_2.3.7&bid=1&app_ua=IncredibleS&uid=&cuid=&fr=3&Bdi_bear=WIFI&from=3_10000&bduss=&pid=1&screen=800_800&sys_ver=2.3.7",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),makeIcon(
          iconUrl = "http://appwk.baidu.com/naapi/doc/view?ih=810&o=jpg_6&iw=1080&ix=0&iy=0&aimw=1080&rn=1&doc_id=5b64dbf576a20029bc642d09&pn=1&sign=80d006ac31d73536a39f3c0583f5c03a&type=1&app_ver=2.9.8.2&ua=bd_800_800_IncredibleS_2.9.8.2_2.3.7&bid=1&app_ua=IncredibleS&uid=&cuid=&fr=3&Bdi_bear=WIFI&from=3_10000&bduss=&pid=1&screen=800_800&sys_ver=2.3.7",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),
      makeIcon(
          iconUrl = "http://appwk.baidu.com/naapi/doc/view?ih=433&o=png_6_0_0_524_155_243_234_892.979_1262.879&iw=449&ix=0&iy=0&aimw=449&rn=1&doc_id=1525dd70227916888586d763&pn=1&sign=69768d9fb0d25066557be464e7d10eb0&type=1&app_ver=2.9.8.2&ua=bd_800_800_IncredibleS_2.9.8.2_2.3.7&bid=1&app_ua=IncredibleS&uid=&cuid=&fr=3&Bdi_bear=WIFI&from=3_10000&bduss=&pid=1&screen=800_800&sys_ver=2.3.7",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),
      makeIcon(
          iconUrl = "http://a0.att.hudong.com/51/77/20300543980828147633779141604_s.jpg",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),
      makeIcon(
          iconUrl = "http://www.absolutechinatours.com/UploadFiles/ImageBase/Ming%20Thirteen%20Tombs2.jpg",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ),
      makeIcon(
          iconUrl = "http://pic.kekenet.com//2014/0401/66191396316877.jpg",
          iconWidth = 50*215/230, iconHeight = 50,
          iconAnchorX = 31*215/230/2, iconAnchorY = 16
      ))
      myLatLong <- data.frame(
          lat = c(39.915503,40.374190,39.9900079,39.880077,39.927332,40.260683,39.90360),
          lng = c(116.390684,116.023009,116.265196,116.402869,116.381001,116.223363,116.391078))
      
      mySites <- c(
          "<a href='https://www.travelchinaguide.com/cityguides/beijing/forbidden.htm'>Forbidden City</a>",
          "<a href='https://www.travelchinaguide.com/china_great_wall/scene/beijing/'>Great Wall in Beijing</a>",
          "<a href='https://www.travelchinaguide.com/cityguides/beijing/summer.htm'>Summer Palace</a>",
          "<a href='https://www.travelchinaguide.com/attraction/beijing/heaven/'>Temple of Heaven</a>",
          "<a href='https://www.travelchinaguide.com/attraction/beijing/beihai.htm'>Beihai Park</a>",
          "<a href='https://www.travelchinaguide.com/attraction/beijing/ming_tomb.htm'>Ming Tombs (Thirteen Tombs of Ming Dynasty)</a>",
          "<a href='https://www.travelchinaguide.com/attraction/beijing/tianan.htm'>Tiananmen Square</a>"
          
      )
      name<-c("Forbidden City","Great Wall","Summer Palace","Temple of Heaven","Beihai Park","Ming Tombs","Tiananmen Square")
      index<-match(input$city,name)
      map<- myLatLong[index,] %>%
          leaflet() %>%
          addTiles() %>%
          addMarkers(icon=myIcon[index], popup = mySites[index])
      if (input$legend==TRUE){
          map %>%addRectangles(lat1=myLatLong[index,1]+0.007,lng1=myLatLong[index,2]-0.01,lat2=myLatLong[index,1]-0.007,lng2=myLatLong[index,2]+0.01)}
      else
          map
  }))
```



